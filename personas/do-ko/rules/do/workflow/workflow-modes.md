# 워크플로우 모드

Do 체크리스트 워크플로우를 위한 개발 방법론 참조.

> **살아있는 체크리스트**: 체크리스트는 구현 중 계속 진화한다. Test Strategy는 코딩 시작 전 항목별로 선언된다. AI 에이전트가 각 항목의 성격을 판단하여 적절한 방법론(TDD/DDD/pass)을 선택 — 모든 항목이 동일한 방법론을 따르지 않는다.

단계 개요, 토큰 전략, 전환에 대해서는 @do-development-workflow.md(이전 spec-workflow.md) 참조

## 방법론 선택

Develop 단계는 프로젝트 분석 또는 사용자 선택에 따라 워크플로우를 적용:

| 모드 | 워크플로우 사이클 | 적합한 상황 | 에이전트 전략 |
|------|---------------|----------|----------------|
| DDD | ANALYZE-PRESERVE-IMPROVE | 기존 프로젝트, 커버리지 10% 미만 | 특성화 테스트 우선 |
| TDD | RED-GREEN-REFACTOR | 신규 프로젝트, 커버리지 50% 이상 | 테스트 먼저 구현 |
| Hybrid | 변경 유형별 혼합 | 부분 커버리지 (10-49%) | 신규 코드: TDD, 레거시: DDD |

## DDD 모드 (기본값)

개발 방법론: Domain-Driven Development (ANALYZE-PRESERVE-IMPROVE)

**ANALYZE**: 기존 동작과 코드 구조 파악
- 기존 코드를 읽고 의존성 식별
- 도메인 경계와 상호작용 패턴 매핑
- 사이드 이펙트와 암묵적 계약 식별

**PRESERVE**: 기존 동작을 위한 특성화 테스트 작성
- 현재 동작을 포착하는 특성화 테스트 작성
- 회귀 감지를 위한 동작 스냅샷 생성
- 주요 경로의 테스트 커버리지 검증

**IMPROVE**: 동작 보존을 유지하며 변경 구현
- 작고 점진적인 변경 수행
- 변경 후마다 특성화 테스트 실행
- 테스트 검증과 함께 리팩토링

성공 기준:
- 모든 체크리스트 요구사항 구현 완료
- 특성화 테스트 통과
- 동작 스냅샷 안정 (회귀 없음)
- 85% 이상 코드 커버리지 달성 (테스트 가능한 코드 기준; CSS/설정/문서는 대안 검증 사용)
- 품질 차원 검증 (Tested/Readable/Unified/Secured/Trackable)
- 커밋-증거: 모든 [o] 체크리스트 항목에 커밋 해시 기록

## TDD 모드

개발 방법론: Test-Driven Development (RED-GREEN-REFACTOR)

**RED**: 실패하는 테스트 작성
- 원하는 동작을 설명하는 테스트 작성
- 테스트가 실패함을 확인 (새로운 것을 테스트한다는 증거)
- 한 번에 하나의 테스트, 집중적이고 구체적으로

**GREEN**: 통과하는 최소한의 코드 작성
- 테스트를 통과하는 가장 단순한 구현 작성
- 조기 최적화나 추상화 금지
- 우아함보다 정확성에 집중

**REFACTOR**: 코드 품질 개선
- 테스트를 녹색으로 유지하면서 구현 정리
- 패턴 추출, 중복 제거
- 적절한 곳에 SOLID 원칙 적용

성공 기준:
- 모든 체크리스트 요구사항 구현 완료
- 모든 테스트 통과 (RED-GREEN-REFACTOR 완료)
- 커밋당 최소 커버리지: 80% (설정 가능)
- 구현 코드 이후 테스트 작성 금지
- 품질 차원 검증 (Tested/Readable/Unified/Secured/Trackable)
- 커밋-증거: 모든 [o] 체크리스트 항목에 커밋 해시 기록

## Hybrid 모드

개발 방법론: Hybrid (신규 코드는 TDD + 레거시는 DDD)

**신규 코드** (새 파일, 새 함수):
- TDD 워크플로우 적용 (RED-GREEN-REFACTOR)
- 테스트 우선 원칙 엄수
- 커버리지 목표: 신규 코드 85%

**기존 코드** (수정, 리팩토링):
- DDD 워크플로우 적용 (ANALYZE-PRESERVE-IMPROVE)
- 변경 전 특성화 테스트 작성
- 커버리지 목표: 수정된 코드 85%

**분류 기준**:
- 새 파일 — TDD 규칙
- 기존 파일 수정 — DDD 규칙
- 기존 파일 내 새 함수 — 해당 함수에 TDD 규칙
- 삭제된 코드 — 특성화 테스트가 여전히 통과하는지 확인

성공 기준:
- 모든 체크리스트 요구사항 구현 완료
- 신규 코드는 TDD 수준 커버리지 (85% 이상)
- 수정된 코드는 특성화 테스트 보유
- 전체적인 커버리지 향상 추세
- 품질 차원 검증 (Tested/Readable/Unified/Secured/Trackable)
- 커밋-증거: 모든 [o] 체크리스트 항목에 커밋 해시 기록

## 방법론 선택 가이드

### 자동 감지

시스템이 프로젝트 분석을 기반으로 방법론을 자동 권장:

| 프로젝트 상태 | 테스트 커버리지 | 권장 | 근거 |
|--------------|---------------|----------------|-----------|
| Greenfield (신규) | 해당 없음 | Hybrid | 깨끗한 시작, 기능은 TDD + DDD 구조 |
| Brownfield | 50% 이상 | TDD | 테스트 기반이 충분해 테스트 우선 개발 가능 |
| Brownfield | 10-49% | Hybrid | 부분적 테스트, DDD로 확장 후 신규는 TDD |
| Brownfield | 10% 미만 | DDD | 테스트 없음, 점진적 특성화 테스트 작성 |

### 수동 재정의

사용자가 자동 감지된 방법론을 재정의할 수 있음:
- 초기화 시: 마법사에서 선택하거나 `--development-mode` 플래그 사용
- 프로젝트별: 프로젝트 설정에서 구성
- 세션별: `DO_DEVELOPMENT_MODE` 환경변수 설정

### 방법론 비교

| 항목 | DDD | TDD | Hybrid |
|--------|-----|-----|--------|
| 테스트 시점 | 분석 후 (PRESERVE) | 코드 전 (RED) | 혼합 |
| 커버리지 접근 | 점진적 개선 | 커밋당 엄격 | 통합 85% 목표 |
| 최적 용도 | 레거시 리팩토링만 | 독립 모듈 (드물게) | 모든 개발 작업 |
| 위험 수준 | 낮음 (동작 보존) | 중간 (규율 필요) | 중간 |
| 커버리지 예외 | 허용 | 불허 | 레거시만 허용 |
| Develop 단계 사이클 | ANALYZE-PRESERVE-IMPROVE | RED-GREEN-REFACTOR | 둘 다 (변경 유형별) |
